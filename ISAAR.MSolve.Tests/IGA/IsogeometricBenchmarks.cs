using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Text;
using ISAAR.MSolve.Analyzers;
using ISAAR.MSolve.Discretization.Interfaces;
using ISAAR.MSolve.IGA;
using ISAAR.MSolve.IGA.Entities;
using ISAAR.MSolve.IGA.Entities.Loads;
using ISAAR.MSolve.IGA.Readers;
using ISAAR.MSolve.Materials;
using ISAAR.MSolve.Numerical.LinearAlgebra;
using ISAAR.MSolve.Problems;
using ISAAR.MSolve.Solvers.Interfaces;
using ISAAR.MSolve.Solvers.Skyline;
using Xunit;

namespace ISAAR.MSolve.Tests.IGA
{
	public class IsogeometricBenchmarks
	{
		//[Fact]
		//public void Qube64()
		//{
		//	// Model
		//	VectorExtensions.AssignTotalAffinityCount();
		//	Model model = new Model();
		//	ModelCreator modelCreator = new ModelCreator(model);
		//	string filename = "..\\..\\..\\IGA\\InputFiles\\Qube4096.txt";
		//	IsogeometricReader modelReader = new IsogeometricReader(modelCreator, filename);
		//	modelReader.CreateModelFromFile();

		//	// Forces and Boundary Conditions
		//	// Loading Conditions - Pressure

		//	model.PatchesDictionary[0].FacesDictionary[3].LoadingConditions.Add(new PressureBoundaryCondition(100));

		//	// Boundary Conditions - Dirichlet
		//	foreach (ControlPoint controlPoint in model.PatchesDictionary[0].FacesDictionary[2].ControlPointsDictionary.Values)
		//	{
		//		model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.X);
		//		model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.Y);
		//		model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.Z);
		//	}
		//	model.ConnectDataStructures();

		//	System.IO.File.WriteAllLines("..\\..\\..\\IGA\\InputFiles\\Qube4096Forces.txt",
		//		model.PatchesDictionary[0].Forces.Select(f=>f.ToString()));

		//}

		[Fact]
		public void IsogeometricQuadraticCantilever2D()
		{
			// Model
			VectorExtensions.AssignTotalAffinityCount();
			Model model = new Model();
			ModelCreator modelCreator = new ModelCreator(model);
			string filename = "..\\..\\..\\IGA\\InputFiles\\Cantilever2D.txt";
			IsogeometricReader modelReader = new IsogeometricReader(modelCreator, filename);
			modelReader.CreateModelFromFile();

			// Forces and Boundary Conditions
			foreach (ControlPoint controlPoint in model.PatchesDictionary[0].EdgesDictionary[1].ControlPointsDictionary.Values)
				model.Loads.Add(new Load() {Amount = -100, ControlPoint = model.ControlPoints[controlPoint.ID], DOF = DOFType.Y});

			// Boundary Conditions - Dirichlet
			foreach (ControlPoint controlPoint in model.PatchesDictionary[0].EdgesDictionary[0].ControlPointsDictionary.Values)
			{
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.X);
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.Y);
			}

			model.ConnectDataStructures();

			// Solvers
			var linearSystems = new Dictionary<int, ILinearSystem>(); //I think this should be done automatically
			linearSystems[0] = new SkylineLinearSystem(0, model.PatchesDictionary[0].Forces);
			SolverSkyline solver = new SolverSkyline(linearSystems[0]);
			ProblemStructural provider = new ProblemStructural(model, linearSystems);
			LinearAnalyzer analyzer = new LinearAnalyzer(solver, linearSystems);
			StaticAnalyzer parentAnalyzer = new StaticAnalyzer(provider, analyzer, linearSystems);

			parentAnalyzer.BuildMatrices();
			parentAnalyzer.Initialize();
			parentAnalyzer.Solve();


			//Test for Load Vector
			int[] loadVectorExpected = new int[108];
			loadVectorExpected[110 - 13] = -100;
			loadVectorExpected[112 - 13] = -100;
			loadVectorExpected[114 - 13] = -100;
			loadVectorExpected[116 - 13] = -100;
			loadVectorExpected[118 - 13] = -100;
			loadVectorExpected[120 - 13] = -100;

			for (int i = 0; i < loadVectorExpected.Length; i++)
				Assert.Equal(loadVectorExpected[i], model.PatchesDictionary[0].Forces[i]);

			//Test fro Displacement Vector
			double[] displacementVectorExpected = new double[]
			{
				-0.0368738351302207, -0.0131499592237545, -0.0236187564608231,
				-0.00591458123276355, -0.00760062703427646, -0.000566403168697526, 0.00760062703427637,
				-0.000566403168697477, 0.0236187564608231, -0.00591458123276345, 0.0368738351302207,
				-0.0131499592237545, -0.0987784914203237, -0.0861605620323561, -0.0733694959613918, -0.0825449187386709,
				-0.0237898071790881, -0.0779453691704672, 0.0237898071790880, -0.0779453691704673, 0.0733694959613916,
				-0.0825449187386711, 0.0987784914203237, -0.0861605620323562, -0.153074952778768, -0.220348665003477,
				-0.112824242793523, -0.216334418527862, -0.0373252643977994, -0.212814901275071, 0.0373252643977993,
				-0.212814901275071, 0.112824242793523, -0.216334418527862, 0.153074952778767, -0.220348665003477,
				-0.197987950979100, -0.403380316332308, -0.146994646367387, -0.400466656395154, -0.0484809128603281,
				-0.397304037977320, 0.0484809128603277, -0.397304037977320, 0.146994646367387, -0.400466656395153,
				0.197987950979101, -0.403380316332307, -0.233979100719325, -0.627050378576386, -0.173875915391434,
				-0.624621548530984, -0.0575789187734497, -0.622325573362235, 0.0575789187734493, -0.622325573362235,
				0.173875915391433, -0.624621548530985, 0.233979100719325, -0.627050378576387, -0.261062696370552,
				-0.882149456584904, -0.194054136046524, -0.880534402771693, -0.0641987082249154, -0.878857804164279,
				0.0641987082249148, -0.878857804164278, 0.194054136046524, -0.880534402771692, 0.261062696370551,
				-0.882149456584903, -0.278878750048815, -1.16007242947546, -0.207837054153937, -1.15891585124500,
				-0.0689580379467459, -1.15768229264197, 0.0689580379467447, -1.15768229264197, 0.207837054153936,
				-1.15891585124500, 0.278878750048814, -1.16007242947546, -0.288294648281518, -1.45007762926002,
				-0.213983781845837, -1.45008375093483, -0.0704137097578954, -1.45093051606850, 0.0704137097578944,
				-1.45093051606850, 0.213983781845836, -1.45008375093483, 0.288294648281518, -1.45007762926002,
				-0.289593315112231, -1.60204696081608, -0.214138050751406, -1.60097881234833, -0.0706978642320891,
				-1.59760921075339, 0.0706978642320882, -1.59760921075338, 0.214138050751405, -1.60097881234833,
				0.289593315112230, -1.60204696081608
			};

			for (int i = 0; i < displacementVectorExpected.Length; i++)
				Assert.Equal(displacementVectorExpected[i], linearSystems[0].Solution[i], 6);
		}

		[Fact]
		public void IsogeometricQuadraticCantilever2DWithDistributedLoad()
		{
			// Model
			VectorExtensions.AssignTotalAffinityCount();
			Model model = new Model();
			ModelCreator modelCreator = new ModelCreator(model);
			string filename = "..\\..\\..\\IGA\\InputFiles\\Cantilever2D.txt";
			IsogeometricReader modelReader = new IsogeometricReader(modelCreator, filename);
			modelReader.CreateModelFromFile();

			// Forces and Boundary Conditions
			Value verticalDistributedLoad = delegate(double x, double y, double z) { return new double[] {0, -100, 0}; };
			model.PatchesDictionary[0].EdgesDictionary[1].LoadingConditions
				.Add(new NeumannBoundaryCondition(verticalDistributedLoad));

			// Boundary Conditions - Dirichlet
			foreach (ControlPoint controlPoint in model.PatchesDictionary[0].EdgesDictionary[0].ControlPointsDictionary.Values)
			{
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.X);
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.Y);
			}

			model.ConnectDataStructures();

			// Solvers
			var linearSystems = new Dictionary<int, ILinearSystem>();
			linearSystems[0] = new SkylineLinearSystem(0, model.PatchesDictionary[0].Forces);
			SolverSkyline solver = new SolverSkyline(linearSystems[0]);
			ProblemStructural provider = new ProblemStructural(model, linearSystems);
			LinearAnalyzer analyzer = new LinearAnalyzer(solver, linearSystems);
			StaticAnalyzer parentAnalyzer = new StaticAnalyzer(provider, analyzer, linearSystems);

			parentAnalyzer.BuildMatrices();
			parentAnalyzer.Initialize();
			parentAnalyzer.Solve();


			//Test for Load Vector
			double[] loadVectorExpected =
			{
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -83.3333333333334, 0, -166.666666666667, 0,
				-250.000000000000, 0, -250.000000000000, 0, -166.666666666667, 0, -83.3333333333334
			};

			for (int i = 0; i < loadVectorExpected.Length; i++)
				Assert.Equal(loadVectorExpected[i], model.PatchesDictionary[0].Forces[i], 6);

			//Test fro Displacement Vector
			double[] displacementVectorExpected = new double[]
			{
				-0.0614562631781765, -0.0219170576325587, -0.0393637953297948, -0.00985891244520424, -0.0126687982396880,
				-0.000943275549340603, 0.0126687982396881, -0.000943275549340565, 0.0393637953297948, -0.00985891244520429,
				0.0614562631781765, -0.0219170576325587, -0.164630630046951, -0.143599796794095, -0.122284459518038,
				-0.137572020341543, -0.0396482606150141, -0.129909984638882, 0.0396482606150142, -0.129909984638882,
				0.122284459518038, -0.137572020341543, 0.164630630046951, -0.143599796794095, -0.255126649525807,
				-0.367249906501344, -0.188034807331162, -0.360563789448209, -0.0622102833016037, -0.354689958832955,
				0.0622102833016041, -0.354689958832955, 0.188034807331162, -0.360563789448210, 0.255126649525807,
				-0.367249906501344, -0.329973104647066, -0.672298362080536, -0.245006560671741, -0.667431304467007,
				-0.0808025488806688, -0.662174063778831, 0.0808025488806692, -0.662174063778831, 0.245006560671741,
				-0.667431304467006, 0.329973104647066, -0.672298362080536, -0.389985650923780, -1.04507710416196,
				-0.289753557243170, -1.04105642269944, -0.0959521766831420, -1.03721560192611, 0.0959521766831417,
				-1.03721560192610, 0.289753557243169, -1.04105642269944, 0.389985650923779, -1.04507710416196,
				-0.435055143301642, -1.47030303359559, -0.323516436156270, -1.46754420136883, -0.107046279714281,
				-1.46472910091973, 0.107046279714280, -1.46472910091973, 0.323516436156269, -1.46754420136883, 0.435055143301642,
				-1.47030303359559, -0.464895102729005, -1.93322992417900, -0.346196414935151, -1.93146777511281,
				-0.114797364187326, -1.92958905082341, 0.114797364187326, -1.92958905082341, 0.346196414935151,
				-1.93146777511282, 0.464895102729004, -1.93322992417900, -0.480254160241311, -2.41767489777727,
				-0.357018220686884, -2.41725889060713, -0.117854053323470, -2.41770706308454, 0.117854053323469,
				-2.41770706308454, 0.357018220686882, -2.41725889060713, 0.480254160241309, -2.41767489777726,
				-0.481234435380421, -2.66710696029277, -0.357129997781511, -2.66655837235305, -0.118099002572320,
				-2.66369484882849, 0.118099002572319, -2.66369484882849, 0.357129997781510, -2.66655837235305, 0.481234435380421,
				-2.66710696029277
			};
			for (int i = 0; i < displacementVectorExpected.Length; i++)
				Assert.Equal(displacementVectorExpected[i], linearSystems[0].Solution[i], 6);
		}

		[Fact]
		public void IsogeometricPlateTension()
		{
			// Model
			VectorExtensions.AssignTotalAffinityCount();
			Model model = new Model();
			ModelCreator modelCreator = new ModelCreator(model);
			string filename = "..\\..\\..\\IGA\\InputFiles\\PlateTension.txt";
			IsogeometricReader modelReader = new IsogeometricReader(modelCreator, filename);
			modelReader.CreateModelFromFile();

			// Forces and Boundary Conditions
			Value horizontalDistributedLoad = delegate (double x, double y, double z) { return new double[] { 100, 0, 0 }; };
			model.PatchesDictionary[0].EdgesDictionary[1].LoadingConditions.Add(new NeumannBoundaryCondition(horizontalDistributedLoad));

			// Boundary Conditions - Dirichlet
			foreach (ControlPoint controlPoint in model.PatchesDictionary[0].EdgesDictionary[0].ControlPointsDictionary.Values)
			{
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.X);
			}
			model.ControlPointsDictionary[0].Constrains.Add(DOFType.Y);

			model.ConnectDataStructures();

			// Solvers
			var linearSystems = new Dictionary<int, ILinearSystem>();
			linearSystems[0] = new SkylineLinearSystem(0, model.PatchesDictionary[0].Forces);
			SolverSkyline solver = new SolverSkyline(linearSystems[0]);
			ProblemStructural provider = new ProblemStructural(model, linearSystems);
			LinearAnalyzer analyzer = new LinearAnalyzer(solver, linearSystems);
			StaticAnalyzer parentAnalyzer = new StaticAnalyzer(provider, analyzer, linearSystems);

			parentAnalyzer.BuildMatrices();
			parentAnalyzer.Initialize();
			parentAnalyzer.Solve();

			double[] forceVectorExpected =
			{
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				2.813476563,
				0,
				5.638671875,
				0,
				8.510742188,
				0,
				11.50390625,
				0,
				11.796875,
				0,
				12.20703125,
				0,
				12.734375,
				0,
				13.37890625,
				0,
				10.47949219,
				0,
				7.232421875,
				0,
				3.704101563,
				0,
			};
			for (int i = 0; i < forceVectorExpected.Length; i++)
				Assert.Equal(forceVectorExpected[i], model.PatchesDictionary[0].Forces[i], 8);

			#region expectedDisplacement

			double[] displacementVectorExpected =
			{
				-0.000146256,
				-0.000438751,
				-0.000882074,
				-0.001334534,
				-0.001800705,
				-0.002285162,
				-0.00279246,
				-0.003327199,
				-0.003704999,
				-0.003899999,
				0.000341248,
				-7.25E-09,
				0.000341253,
				-0.00014625,
				0.000341246,
				-0.000438757,
				0.000341253,
				-0.00088207,
				0.000341247,
				-0.001334537,
				0.000341252,
				-0.001800705,
				0.000341249,
				-0.002285157,
				0.000341247,
				-0.002792472,
				0.000341263,
				-0.003327173,
				0.000341224,
				-0.003705018,
				0.000341261,
				-0.003900014,
				0.001023752,
				-3.43E-13,
				0.001023744,
				-0.000146257,
				0.001023757,
				-0.000438746,
				0.001023742,
				-0.000882079,
				0.001023758,
				-0.001334528,
				0.001023743,
				-0.001800711,
				0.001023754,
				-0.002285159,
				0.001023755,
				-0.002792456,
				0.001023724,
				-0.003327216,
				0.001023809,
				-0.00370498,
				0.001023732,
				-0.003899995,
				0.00205816,
				-6.57E-09,
				0.002058168,
				-0.00014625,
				0.002058153,
				-0.000438762,
				0.002058174,
				-0.000882065,
				0.002058151,
				-0.001334544,
				0.002058177,
				-0.001800696,
				0.002058155,
				-0.002285166,
				0.002058162,
				-0.002792467,
				0.002058201,
				-0.003327172,
				0.002058075,
				-0.00370503,
				0.002058194,
				-0.003900003,
				0.003113908,
				5.09E-10,
				0.003113896,
				-0.000146258,
				0.003113922,
				-0.000438741,
				0.003113886,
				-0.000882088,
				0.003113929,
				-0.001334515,
				0.00311388,
				-0.001800728,
				0.00311393,
				-0.002285137,
				0.003113904,
				-0.002792481,
				0.003113852,
				-0.003327193,
				0.00311407,
				-0.003704984,
				0.003113858,
				-0.003900043,
				0.004201632,
				-1.28E-08,
				0.004201651,
				-0.00014625,
				0.004201609,
				-0.000438773,
				0.004201673,
				-0.000882051,
				0.004201595,
				-0.00133457,
				0.004201694,
				-0.001800657,
				0.00420159,
				-0.00228522,
				0.004201668,
				-0.002792395,
				0.004201722,
				-0.003327265,
				0.004201363,
				-0.003704993,
				0.004201716,
				-0.003899863,
				0.00533204,
				9.73E-09,
				0.005332006,
				-0.000146258,
				0.005332079,
				-0.000438732,
				0.005331968,
				-0.000882113,
				0.005332111,
				-0.001334471,
				0.005331923,
				-0.001800805,
				0.005332149,
				-0.00228501,
				0.005331957,
				-0.002792662,
				0.005331965,
				-0.003326937,
				0.005332439,
				-0.003705134,
				0.005331965,
				-0.003900417,
				0.006515714,
				-3.75E-08,
				0.006515781,
				-0.00014626,
				0.006515657,
				-0.000438787,
				0.006515838,
				-0.000882016,
				0.006515598,
				-0.001334655,
				0.006515925,
				-0.001800499,
				0.006515523,
				-0.002285491,
				0.006515942,
				-0.002791946,
				0.006515783,
				-0.003327922,
				0.006515237,
				-0.003704656,
				0.006515668,
				-0.003898999,
				0.007763498,
				5.72E-08,
				0.007763343,
				-0.000146237,
				0.007763593,
				-0.000438734,
				0.00776324,
				-0.00088218,
				0.007763706,
				-0.001334301,
				0.007763035,
				-0.001801172,
				0.007763936,
				-0.002284351,
				0.007762843,
				-0.002793734,
				0.007764044,
				-0.003325117,
				0.007763485,
				-0.003706045,
				0.007764022,
				-0.003902662,
				0.008644866,
				-1.29E-07,
				0.00864517,
				-0.000146322,
				0.008644803,
				-0.000438748,
				0.008645196,
				-0.000881942,
				0.00864469,
				-0.001334917,
				0.008645477,
				-0.001799884,
				0.008644261,
				-0.00228676,
				0.008646,
				-0.00278979,
				0.008643379,
				-0.003331508,
				0.008647443,
				-0.003702447,
				0.008641489,
				-0.003894147,
				0.00910031,
				1.35E-07,
				0.009099715,
				-0.000146173,
				0.009100131,
				-0.000438822,
				0.009099933,
				-0.000882057,
				0.009100099,
				-0.001334479,
				0.009099651,
				-0.001800931,
				0.009101019,
				-0.002284642,
				0.009097205,
				-0.00279357,
				0.009107416,
				-0.003325298,
				0.009086905,
				-0.003706366,
				0.009112171,
				-0.003906529
			};
			for (int i = 0; i < displacementVectorExpected.Length; i++)
				Assert.Equal(displacementVectorExpected[i], linearSystems[0].Solution[i], 4);

			#endregion
		}

		//[Fact]
		public void IsogeometricPlateWithHole()
		{
			// Model
			VectorExtensions.AssignTotalAffinityCount();
			Model model = new Model();
			ModelCreator modelCreator = new ModelCreator(model);
			string filename = "..\\..\\..\\IGA\\InputFiles\\PlateTension.txt";
			IsogeometricReader modelReader = new IsogeometricReader(modelCreator, filename);
			modelReader.CreateModelFromFile();

			// Forces and Boundary Conditions
			Value horizontalDistributedLoad = delegate (double x, double y, double z) { return new double[] { 100, 0, 0 }; };
			model.PatchesDictionary[0].EdgesDictionary[1].LoadingConditions.Add(new NeumannBoundaryCondition(horizontalDistributedLoad));

			// Boundary Conditions - Dirichlet
			foreach (ControlPoint controlPoint in model.PatchesDictionary[0].EdgesDictionary[0].ControlPointsDictionary.Values)
			{
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.X);
			}
			model.ControlPointsDictionary[0].Constrains.Add(DOFType.Y);

			model.ConnectDataStructures();

			// Solvers
			var linearSystems = new Dictionary<int, ILinearSystem>();
			linearSystems[0] = new SkylineLinearSystem(0, model.PatchesDictionary[0].Forces);
			SolverSkyline solver = new SolverSkyline(linearSystems[0]);
			ProblemStructural provider = new ProblemStructural(model, linearSystems);
			LinearAnalyzer analyzer = new LinearAnalyzer(solver, linearSystems);
			StaticAnalyzer parentAnalyzer = new StaticAnalyzer(provider, analyzer, linearSystems);

			parentAnalyzer.BuildMatrices();
			parentAnalyzer.Initialize();
			parentAnalyzer.Solve();

			double[] forceVectorExpected =
			{
				
			};
			for (int i = 0; i < forceVectorExpected.Length; i++)
				Assert.Equal(forceVectorExpected[i], model.PatchesDictionary[0].Forces[i], 8);

			#region expectedDisplacement

			double[] displacementVectorExpected =
			{
				
			};
			for (int i = 0; i < displacementVectorExpected.Length; i++)
				Assert.Equal(displacementVectorExpected[i], linearSystems[0].Solution[i], 4);

			#endregion
		}

		//[Fact]
		public void IsogeometricBeam3D()
		{
			VectorExtensions.AssignTotalAffinityCount();
			Model model = new Model();
			ModelCreator modelCreator = new ModelCreator(model);
			string filename = "..\\..\\..\\IGA\\InputFiles\\Beam3D.txt";
			IsogeometricReader modelReader = new IsogeometricReader(modelCreator, filename);
			modelReader.CreateModelFromFile();

			// Forces and Boundary Conditions
			foreach (ControlPoint controlPoint in model.PatchesDictionary[0].FacesDictionary[1].ControlPointsDictionary.Values)
			{
				model.Loads.Add(new Load() { Amount = -100, ControlPoint = model.ControlPoints[controlPoint.ID], DOF = DOFType.Z });
			}


			// Boundary Conditions - Dirichlet
			foreach (ControlPoint controlPoint in model.PatchesDictionary[0].FacesDictionary[0].ControlPointsDictionary.Values)
			{
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.X);
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.Y);
				model.ControlPointsDictionary[controlPoint.ID].Constrains.Add(DOFType.Z);
			}

			model.ConnectDataStructures();

			// Solvers
			var linearSystems = new Dictionary<int, ILinearSystem>();
			linearSystems[0] = new SkylineLinearSystem(0, model.PatchesDictionary[0].Forces);
			SolverSkyline solver = new SolverSkyline(linearSystems[0]);
			ProblemStructural provider = new ProblemStructural(model, linearSystems);
			LinearAnalyzer analyzer = new LinearAnalyzer(solver, linearSystems);
			StaticAnalyzer parentAnalyzer = new StaticAnalyzer(provider, analyzer, linearSystems);

			parentAnalyzer.BuildMatrices();
			parentAnalyzer.Initialize();
			parentAnalyzer.Solve();

			#region expectedDisplacement

			//double[] displacementVectorExpected =
			//{
			//	-0.0588147211713687,
			//	-0.0318891307200264,
			//	-0.0138605371262691,
			//	-0.0296884699073511,
			//	-0.0171092333977689,
			//	0.0084200104478053,
			//	0.0000000000000008,
			//	0.0000000000000005,
			//	0.0097108976309664,
			//	0.0296884699073526,
			//	0.0171092333977699,
			//	0.0084200104478051,
			//	0.0588147211713705,
			//	0.0318891307200274,
			//	-0.0138605371262699,
			//	-0.0478571584832597,
			//	-0.0100134161749745,
			//	-0.0278436122610041,
			//	-0.0175431989169527,
			//	-0.0044386399785482,
			//	-0.0061210740440649,
			//	0.0000000000000005,
			//	0.0000000000000002,
			//	-0.0062780934427213,
			//	0.0175431989169534,
			//	0.0044386399785486,
			//	-0.0061210740440651,
			//	0.0478571584832611,
			//	0.0100134161749749,
			//	-0.0278436122610049,
			//	-0.0581522480502688,
			//	-0.0055782483376870,
			//	-0.0312793321984928,
			//	-0.0210448496913648,
			//	-0.0033148547674199,
			//	-0.0057442658375095,
			//	0.0000000000000006,
			//	0.0000000000000002,
			//	-0.0067259947990686,
			//	0.0210448496913660,
			//	0.0033148547674202,
			//	-0.0057442658375097,
			//	0.0581522480502704,
			//	0.0055782483376874,
			//	-0.0312793321984937,
			//	-0.0571577664574691,
			//	0.0000000000000004,
			//	-0.0323029890864245,
			//	-0.0201934498973269,
			//	0.0000000000000002,
			//	-0.0074772814395880,
			//	0.0000000000000006,
			//	0.0000000000000001,
			//	-0.0087801500046148,
			//	0.0201934498973281,
			//	-0.0000000000000002,
			//	-0.0074772814395883,
			//	0.0571577664574708,
			//	-0.0000000000000003,
			//	-0.0323029890864255,
			//	-0.0581522480502683,
			//	0.0055782483376879,
			//	-0.0312793321984922,
			//	-0.0210448496913646,
			//	0.0033148547674204,
			//	-0.0057442658375093,
			//	0.0000000000000007,
			//	-0.0000000000000001,
			//	-0.0067259947990682,
			//	0.0210448496913660,
			//	-0.0033148547674206,
			//	-0.0057442658375096,
			//	0.0581522480502701,
			//	-0.0055782483376880,
			//	-0.0312793321984934,
			//	-0.0478571584832584,
			//	0.0100134161749751,
			//	-0.0278436122610032,
			//	-0.0175431989169522,
			//	0.0044386399785485,
			//	-0.0061210740440643,
			//	0.0000000000000007,
			//	-0.0000000000000002,
			//	-0.0062780934427208,
			//	0.0175431989169534,
			//	-0.0044386399785488,
			//	-0.0061210740440646,
			//	0.0478571584832606,
			//	-0.0100134161749753,
			//	-0.0278436122610044,
			//	-0.0588147211713672,
			//	0.0318891307200265,
			//	-0.0138605371262677,
			//	-0.0296884699073507,
			//	0.0171092333977687,
			//	0.0084200104478061,
			//	0.0000000000000013,
			//	-0.0000000000000007,
			//	0.0097108976309675,
			//	0.0296884699073532,
			//	-0.0171092333977703,
			//	0.0084200104478058,
			//	0.0588147211713703,
			//	-0.0318891307200279,
			//	-0.0138605371262691,
			//	-0.1138237921634480,
			//	-0.0404588036996406,
			//	-0.0487885105947686,
			//	-0.0589077258684291,
			//	-0.0209687469265622,
			//	-0.0356609265429763,
			//	0.0000000000000013,
			//	0.0000000000000007,
			//	-0.0309899647635677,
			//	0.0589077258684318,
			//	0.0209687469265634,
			//	-0.0356609265429768,
			//	0.1138237921634500,
			//	0.0404588036996418,
			//	-0.0487885105947693,
			//	-0.1105132431537000,
			//	-0.0217250110802674,
			//	-0.0722905169306445,
			//	-0.0547281028772435,
			//	-0.0111952298291282,
			//	-0.0565109068589760,
			//	0.0000000000000012,
			//	0.0000000000000005,
			//	-0.0511637902180050,
			//	0.0547281028772462,
			//	0.0111952298291291,
			//	-0.0565109068589762,
			//	0.1105132431537020,
			//	0.0217250110802683,
			//	-0.0722905169306453,
			//	-0.1129909893262330,
			//	-0.0072895587112103,
			//	-0.0788480235430297,
			//	-0.0540986376732441,
			//	-0.0040077096805715,
			//	-0.0622358152122355,
			//	0.0000000000000014,
			//	0.0000000000000001,
			//	-0.0552606659219908,
			//	0.0540986376732467,
			//	0.0040077096805719,
			//	-0.0622358152122363,
			//	0.1129909893262360,
			//	0.0072895587112107,
			//	-0.0788480235430307,
			//	-0.1150148898038330,
			//	0.0000000000000007,
			//	-0.0816277729776511,
			//	-0.0551940032529435,
			//	0.0000000000000003,
			//	-0.0642683328647059,
			//	0.0000000000000015,
			//	0.0000000000000000,
			//	-0.0577779877591315,
			//	0.0551940032529466,
			//	-0.0000000000000003,
			//	-0.0642683328647063,
			//	0.1150148898038360,
			//	-0.0000000000000006,
			//	-0.0816277729776522,
			//	-0.1129909893262320,
			//	0.0072895587112116,
			//	-0.0788480235430288,
			//	-0.0540986376732435,
			//	0.0040077096805721,
			//	-0.0622358152122347,
			//	0.0000000000000017,
			//	-0.0000000000000003,
			//	-0.0552606659219901,
			//	0.0540986376732469,
			//	-0.0040077096805726,
			//	-0.0622358152122354,
			//	0.1129909893262360,
			//	-0.0072895587112119,
			//	-0.0788480235430302,
			//	-0.1105132431536980,
			//	0.0217250110802684,
			//	-0.0722905169306425,
			//	-0.0547281028772423,
			//	0.0111952298291286,
			//	-0.0565109068589741,
			//	0.0000000000000020,
			//	-0.0000000000000006,
			//	-0.0511637902180033,
			//	0.0547281028772466,
			//	-0.0111952298291299,
			//	-0.0565109068589750,
			//	0.1105132431537020,
			//	-0.0217250110802697,
			//	-0.0722905169306440,
			//	-0.1138237921634460,
			//	0.0404588036996412,
			//	-0.0487885105947660,
			//	-0.0589077258684278,
			//	0.0209687469265623,
			//	-0.0356609265429737,
			//	0.0000000000000024,
			//	-0.0000000000000011,
			//	-0.0309899647635658,
			//	0.0589077258684328,
			//	-0.0209687469265644,
			//	-0.0356609265429745,
			//	0.1138237921634510,
			//	-0.0404588036996433,
			//	-0.0487885105947674,
			//	-0.1676184507420140,
			//	-0.0463499528169392,
			//	-0.1162387314129040,
			//	-0.0845512613918211,
			//	-0.0234328413978522,
			//	-0.1011012770363000,
			//	0.0000000000000018,
			//	0.0000000000000007,
			//	-0.0991755919865027,
			//	0.0845512613918248,
			//	0.0234328413978535,
			//	-0.1011012770363010,
			//	0.1676184507420180,
			//	0.0463499528169404,
			//	-0.1162387314129050,
			//	-0.1655316765959690,
			//	-0.0265526786780308,
			//	-0.1424392233012980,
			//	-0.0823225295713645,
			//	-0.0132618705865243,
			//	-0.1271323928725840,
			//	0.0000000000000020,
			//	0.0000000000000004,
			//	-0.1249046001694690,
			//	0.0823225295713681,
			//	0.0132618705865252,
			//	-0.1271323928725840,
			//	0.1655316765959730,
			//	0.0265526786780317,
			//	-0.1424392233012980,
			//	-0.1678536230899090,
			//	-0.0108009881271304,
			//	-0.1522735010746210,
			//	-0.0825605663317256,
			//	-0.0058489980786135,
			//	-0.1348595658038860,
			//	0.0000000000000022,
			//	0.0000000000000003,
			//	-0.1321820525791830,
			//	0.0825605663317302,
			//	0.0058489980786137,
			//	-0.1348595658038870,
			//	0.1678536230899130,
			//	0.0108009881271308,
			//	-0.1522735010746230,
			//	-0.1680044973091010,
			//	0.0000000000000008,
			//	-0.1557574227713460,
			//	-0.0823790709537943,
			//	0.0000000000000004,
			//	-0.1381098661511570,
			//	0.0000000000000025,
			//	-0.0000000000000002,
			//	-0.1356736030253880,
			//	0.0823790709537991,
			//	-0.0000000000000006,
			//	-0.1381098661511580,
			//	0.1680044973091060,
			//	-0.0000000000000010,
			//	-0.1557574227713470,
			//	-0.1678536230899080,
			//	0.0108009881271321,
			//	-0.1522735010746200,
			//	-0.0825605663317247,
			//	0.0058489980786139,
			//	-0.1348595658038850,
			//	0.0000000000000029,
			//	-0.0000000000000006,
			//	-0.1321820525791820,
			//	0.0825605663317306,
			//	-0.0058489980786150,
			//	-0.1348595658038860,
			//	0.1678536230899130,
			//	-0.0108009881271330,
			//	-0.1522735010746210,
			//	-0.1655316765959660,
			//	0.0265526786780321,
			//	-0.1424392233012950,
			//	-0.0823225295713627,
			//	0.0132618705865247,
			//	-0.1271323928725810,
			//	0.0000000000000032,
			//	-0.0000000000000009,
			//	-0.1249046001694670,
			//	0.0823225295713689,
			//	-0.0132618705865266,
			//	-0.1271323928725820,
			//	0.1655316765959730,
			//	-0.0265526786780339,
			//	-0.1424392233012960,
			//	-0.1676184507420110,
			//	0.0463499528169401,
			//	-0.1162387314129000,
			//	-0.0845512613918190,
			//	0.0234328413978525,
			//	-0.1011012770362970,
			//	0.0000000000000037,
			//	-0.0000000000000014,
			//	-0.0991755919864988,
			//	0.0845512613918264,
			//	-0.0234328413978552,
			//	-0.1011012770362980,
			//	0.1676184507420180,
			//	-0.0463499528169429,
			//	-0.1162387314129020,
			//	-0.2203021402723070,
			//	-0.0483948445715230,
			//	-0.2124458829686870,
			//	-0.1098033184104240,
			//	-0.0245361878693831,
			//	-0.1990952093423040,
			//	0.0000000000000024,
			//	0.0000000000000005,
			//	-0.1965864721785110,
			//	0.1098033184104290,
			//	0.0245361878693842,
			//	-0.1990952093423040,
			//	0.2203021402723120,
			//	0.0483948445715237,
			//	-0.2124458829686880,
			//	-0.2199324716421480,
			//	-0.0294147671978247,
			//	-0.2408363217494510,
			//	-0.1090548135329480,
			//	-0.0146305222832313,
			//	-0.2268127384151420,
			//	0.0000000000000025,
			//	0.0000000000000003,
			//	-0.2240833835868950,
			//	0.1090548135329530,
			//	0.0146305222832320,
			//	-0.2268127384151420,
			//	0.2199324716421530,
			//	0.0294147671978254,
			//	-0.2408363217494520,
			//	-0.2207651495025500,
			//	-0.0125372685000990,
			//	-0.2521241649496880,
			//	-0.1088907689764250,
			//	-0.0067072339165759,
			//	-0.2372545625472820,
			//	0.0000000000000030,
			//	0.0000000000000000,
			//	-0.2338971128890630,
			//	0.1088907689764310,
			//	0.0067072339165759,
			//	-0.2372545625472830,
			//	0.2207651495025560,
			//	0.0125372685000990,
			//	-0.2521241649496890,
			//	-0.2212223696531260,
			//	0.0000000000000010,
			//	-0.2564566898691640,
			//	-0.1089665576447760,
			//	0.0000000000000002,
			//	-0.2409761702332700,
			//	0.0000000000000036,
			//	-0.0000000000000003,
			//	-0.2379824812807350,
			//	0.1089665576447820,
			//	-0.0000000000000010,
			//	-0.2409761702332700,
			//	0.2212223696531330,
			//	-0.0000000000000017,
			//	-0.2564566898691650,
			//	-0.2207651495025490,
			//	0.0125372685001006,
			//	-0.2521241649496860,
			//	-0.1088907689764240,
			//	0.0067072339165763,
			//	-0.2372545625472800,
			//	0.0000000000000039,
			//	-0.0000000000000009,
			//	-0.2338971128890610,
			//	0.1088907689764320,
			//	-0.0067072339165779,
			//	-0.2372545625472810,
			//	0.2207651495025560,
			//	-0.0125372685001022,
			//	-0.2521241649496870,
			//	-0.2199324716421450,
			//	0.0294147671978262,
			//	-0.2408363217494480,
			//	-0.1090548135329460,
			//	0.0146305222832315,
			//	-0.2268127384151380,
			//	0.0000000000000043,
			//	-0.0000000000000012,
			//	-0.2240833835868920,
			//	0.1090548135329550,
			//	-0.0146305222832342,
			//	-0.2268127384151390,
			//	0.2199324716421540,
			//	-0.0294147671978286,
			//	-0.2408363217494490,
			//	-0.2203021402723040,
			//	0.0483948445715241,
			//	-0.2124458829686820,
			//	-0.1098033184104220,
			//	0.0245361878693832,
			//	-0.1990952093422990,
			//	0.0000000000000049,
			//	-0.0000000000000017,
			//	-0.1965864721785070,
			//	0.1098033184104310,
			//	-0.0245361878693867,
			//	-0.1990952093422990,
			//	0.2203021402723130,
			//	-0.0483948445715274,
			//	-0.2124458829686840,
			//	-0.2698415175439570,
			//	-0.0485571126864838,
			//	-0.3364098614631650,
			//	-0.1339679398779270,
			//	-0.0245269318105988,
			//	-0.3234706844614380,
			//	0.0000000000000026,
			//	0.0000000000000004,
			//	-0.3212992859365240,
			//	0.1339679398779330,
			//	0.0245269318105992,
			//	-0.3234706844614390,
			//	0.2698415175439620,
			//	0.0485571126864837,
			//	-0.3364098614631660,
			//	-0.2701324773833140,
			//	-0.0305681072845771,
			//	-0.3650476021602720,
			//	-0.1341866434097420,
			//	-0.0151141823676406,
			//	-0.3520254387355160,
			//	0.0000000000000036,
			//	0.0000000000000001,
			//	-0.3495974031028270,
			//	0.1341866434097470,
			//	0.0151141823676407,
			//	-0.3520254387355150,
			//	0.2701324773833200,
			//	0.0305681072845772,
			//	-0.3650476021602720,
			//	-0.2703473630812350,
			//	-0.0135919183474039,
			//	-0.3775568793852650,
			//	-0.1340100673271470,
			//	-0.0071795963781400,
			//	-0.3636500959584920,
			//	0.0000000000000036,
			//	-0.0000000000000003,
			//	-0.3608533889581700,
			//	0.1340100673271560,
			//	0.0071795963781392,
			//	-0.3636500959584930,
			//	0.2703473630812420,
			//	0.0135919183474033,
			//	-0.3775568793852660,
			//	-0.2704780049586560,
			//	0.0000000000000008,
			//	-0.3821816691632940,
			//	-0.1339699021353470,
			//	0.0000000000000001,
			//	-0.3679729766092370,
			//	0.0000000000000046,
			//	-0.0000000000000008,
			//	-0.3654910294156940,
			//	0.1339699021353550,
			//	-0.0000000000000014,
			//	-0.3679729766092370,
			//	0.2704780049586650,
			//	-0.0000000000000022,
			//	-0.3821816691632940,
			//	-0.2703473630812330,
			//	0.0135919183474056,
			//	-0.3775568793852630,
			//	-0.1340100673271460,
			//	0.0071795963781399,
			//	-0.3636500959584900,
			//	0.0000000000000049,
			//	-0.0000000000000012,
			//	-0.3608533889581670,
			//	0.1340100673271570,
			//	-0.0071795963781424,
			//	-0.3636500959584910,
			//	0.2703473630812420,
			//	-0.0135919183474077,
			//	-0.3775568793852640,
			//	-0.2701324773833110,
			//	0.0305681072845787,
			//	-0.3650476021602670,
			//	-0.1341866434097390,
			//	0.0151141823676403,
			//	-0.3520254387355110,
			//	0.0000000000000056,
			//	-0.0000000000000016,
			//	-0.3495974031028240,
			//	0.1341866434097490,
			//	-0.0151141823676436,
			//	-0.3520254387355110,
			//	0.2701324773833220,
			//	-0.0305681072845822,
			//	-0.3650476021602680,
			//	-0.2698415175439520,
			//	0.0485571126864846,
			//	-0.3364098614631580,
			//	-0.1339679398779240,
			//	0.0245269318105984,
			//	-0.3234706844614320,
			//	0.0000000000000059,
			//	-0.0000000000000022,
			//	-0.3212992859365170,
			//	0.1339679398779360,
			//	-0.0245269318106027,
			//	-0.3234706844614330,
			//	0.2698415175439630,
			//	-0.0485571126864888,
			//	-0.3364098614631590,
			//	-0.3166627050337290,
			//	-0.0475757582055530,
			//	-0.4854235808845170,
			//	-0.1569525345002900,
			//	-0.0240045395463972,
			//	-0.4734162199759920,
			//	0.0000000000000031,
			//	-0.0000000000000001,
			//	-0.4712932078777130,
			//	0.1569525345002960,
			//	0.0240045395463968,
			//	-0.4734162199759920,
			//	0.3166627050337350,
			//	0.0475757582055521,
			//	-0.4854235808845180,
			//	-0.3174478926068050,
			//	-0.0306057318309221,
			//	-0.5137601883028910,
			//	-0.1576822151966870,
			//	-0.0150795303062426,
			//	-0.5016326149547410,
			//	0.0000000000000038,
			//	-0.0000000000000002,
			//	-0.4993464295241000,
			//	0.1576822151966950,
			//	0.0150795303062420,
			//	-0.5016326149547400,
			//	0.3174478926068120,
			//	0.0306057318309211,
			//	-0.5137601883028910,
			//	-0.3171038570913230,
			//	-0.0139653870043876,
			//	-0.5266212153988450,
			//	-0.1574723772962730,
			//	-0.0073152291068292,
			//	-0.5140125233067280,
			//	0.0000000000000047,
			//	-0.0000000000000006,
			//	-0.5113793639099390,
			//	0.1574723772962820,
			//	0.0073152291068274,
			//	-0.5140125233067280,
			//	0.3171038570913330,
			//	0.0139653870043864,
			//	-0.5266212153988450,
			//	-0.3171701280811330,
			//	0.0000000000000005,
			//	-0.5314779728399780,
			//	-0.1574352712200710,
			//	-0.0000000000000001,
			//	-0.5185372326674530,
			//	0.0000000000000054,
			//	-0.0000000000000014,
			//	-0.5162445789410600,
			//	0.1574352712200810,
			//	-0.0000000000000021,
			//	-0.5185372326674530,
			//	0.3171701280811430,
			//	-0.0000000000000028,
			//	-0.5314779728399790,
			//	-0.3171038570913220,
			//	0.0139653870043894,
			//	-0.5266212153988420,
			//	-0.1574723772962710,
			//	0.0073152291068284,
			//	-0.5140125233067250,
			//	0.0000000000000058,
			//	-0.0000000000000016,
			//	-0.5113793639099360,
			//	0.1574723772962830,
			//	-0.0073152291068317,
			//	-0.5140125233067260,
			//	0.3171038570913340,
			//	-0.0139653870043925,
			//	-0.5266212153988430,
			//	-0.3174478926068010,
			//	0.0306057318309230,
			//	-0.5137601883028850,
			//	-0.1576822151966840,
			//	0.0150795303062417,
			//	-0.5016326149547360,
			//	0.0000000000000065,
			//	-0.0000000000000021,
			//	-0.4993464295240950,
			//	0.1576822151966970,
			//	-0.0150795303062460,
			//	-0.5016326149547350,
			//	0.3174478926068140,
			//	-0.0306057318309269,
			//	-0.5137601883028870,
			//	-0.3166627050337240,
			//	0.0475757582055538,
			//	-0.4854235808845100,
			//	-0.1569525345002860,
			//	0.0240045395463963,
			//	-0.4734162199759840,
			//	0.0000000000000073,
			//	-0.0000000000000027,
			//	-0.4712932078777060,
			//	0.1569525345003000,
			//	-0.0240045395464014,
			//	-0.4734162199759850,
			//	0.3166627050337380,
			//	-0.0475757582055586,
			//	-0.4854235808845110,
			//	-0.3603725712685210,
			//	-0.0457293547233266,
			//	-0.6579387602420550,
			//	-0.1785140885214760,
			//	-0.0230468991891927,
			//	-0.6467264292167020,
			//	0.0000000000000034,
			//	-0.0000000000000006,
			//	-0.6447692440463670,
			//	0.1785140885214830,
			//	0.0230468991891915,
			//	-0.6467264292167020,
			//	0.3603725712685270,
			//	0.0457293547233242,
			//	-0.6579387602420560,
			//	-0.3614742593143310,
			//	-0.0298977178285135,
			//	-0.6853091483758940,
			//	-0.1796535308446500,
			//	-0.0146989119710964,
			//	-0.6741019514260340,
			//	0.0000000000000042,
			//	-0.0000000000000009,
			//	-0.6719614578393090,
			//	0.1796535308446580,
			//	0.0146989119710945,
			//	-0.6741019514260330,
			//	0.3614742593143390,
			//	0.0298977178285122,
			//	-0.6853091483758940,
			//	-0.3607300517047980,
			//	-0.0138729619005270,
			//	-0.6981710502651800,
			//	-0.1793915753456630,
			//	-0.0072178240433671,
			//	-0.6865956094912360,
			//	0.0000000000000053,
			//	-0.0000000000000012,
			//	-0.6842000896344050,
			//	0.1793915753456740,
			//	0.0072178240433647,
			//	-0.6865956094912370,
			//	0.3607300517048070,
			//	0.0138729619005240,
			//	-0.6981710502651790,
			//	-0.3607008899764000,
			//	0.0000000000000006,
			//	-0.7030173620510250,
			//	-0.1793518023216610,
			//	-0.0000000000000007,
			//	-0.6912123169183380,
			//	0.0000000000000060,
			//	-0.0000000000000015,
			//	-0.6891281733632610,
			//	0.1793518023216730,
			//	-0.0000000000000031,
			//	-0.6912123169183360,
			//	0.3607008899764120,
			//	-0.0000000000000036,
			//	-0.7030173620510260,
			//	-0.3607300517047950,
			//	0.0138729619005276,
			//	-0.6981710502651760,
			//	-0.1793915753456620,
			//	0.0072178240433654,
			//	-0.6865956094912330,
			//	0.0000000000000072,
			//	-0.0000000000000026,
			//	-0.6842000896344010,
			//	0.1793915753456760,
			//	-0.0072178240433696,
			//	-0.6865956094912350,
			//	0.3607300517048070,
			//	-0.0138729619005316,
			//	-0.6981710502651770,
			//	-0.3614742593143270,
			//	0.0298977178285148,
			//	-0.6853091483758880,
			//	-0.1796535308446450,
			//	0.0146989119710947,
			//	-0.6741019514260260,
			//	0.0000000000000073,
			//	-0.0000000000000023,
			//	-0.6719614578393040,
			//	0.1796535308446610,
			//	-0.0146989119711002,
			//	-0.6741019514260260,
			//	0.3614742593143420,
			//	-0.0298977178285199,
			//	-0.6853091483758880,
			//	-0.3603725712685150,
			//	0.0457293547233259,
			//	-0.6579387602420460,
			//	-0.1785140885214710,
			//	0.0230468991891917,
			//	-0.6467264292166930,
			//	0.0000000000000083,
			//	-0.0000000000000035,
			//	-0.6447692440463580,
			//	0.1785140885214880,
			//	-0.0230468991891970,
			//	-0.6467264292166940,
			//	0.3603725712685310,
			//	-0.0457293547233320,
			//	-0.6579387602420470,
			//	-0.4009748488033030,
			//	-0.0433164473153617,
			//	-0.8520657500708890,
			//	-0.1986097356524790,
			//	-0.0218140147785636,
			//	-0.8417126747463990,
			//	0.0000000000000036,
			//	-0.0000000000000010,
			//	-0.8398906081346170,
			//	0.1986097356524860,
			//	0.0218140147785602,
			//	-0.8417126747463990,
			//	0.4009748488033100,
			//	0.0433164473153587,
			//	-0.8520657500708890,
			//	-0.4022954791496420,
			//	-0.0286340716657150,
			//	-0.8780971439662220,
			//	-0.2000115337405040,
			//	-0.0140546359720445,
			//	-0.8677718655168190,
			//	0.0000000000000044,
			//	-0.0000000000000017,
			//	-0.8658025018107650,
			//	0.2000115337405130,
			//	0.0140546359720418,
			//	-0.8677718655168170,
			//	0.4022954791496520,
			//	0.0286340716657118,
			//	-0.8780971439662210,
			//	-0.4012647587850100,
			//	-0.0134509610693191,
			//	-0.8905910439116180,
			//	-0.1997259949265210,
			//	-0.0069676250356296,
			//	-0.8800413405794170,
			//	0.0000000000000062,
			//	-0.0000000000000017,
			//	-0.8778497397872290,
			//	0.1997259949265320,
			//	0.0069676250356253,
			//	-0.8800413405794180,
			//	0.4012647587850220,
			//	0.0134509610693152,
			//	-0.8905910439116210,
			//	-0.4011703360616540,
			//	-0.0000000000000002,
			//	-0.8953249925456590,
			//	-0.1996749314408900,
			//	-0.0000000000000010,
			//	-0.8845724711328950,
			//	0.0000000000000073,
			//	-0.0000000000000025,
			//	-0.8826846869120620,
			//	0.1996749314409030,
			//	-0.0000000000000030,
			//	-0.8845724711328940,
			//	0.4011703360616670,
			//	-0.0000000000000045,
			//	-0.8953249925456570,
			//	-0.4012647587850070,
			//	0.0134509610693197,
			//	-0.8905910439116140,
			//	-0.1997259949265190,
			//	0.0069676250356263,
			//	-0.8800413405794140,
			//	0.0000000000000077,
			//	-0.0000000000000027,
			//	-0.8778497397872260,
			//	0.1997259949265350,
			//	-0.0069676250356329,
			//	-0.8800413405794140,
			//	0.4012647587850230,
			//	-0.0134509610693247,
			//	-0.8905910439116160,
			//	-0.4022954791496380,
			//	0.0286340716657144,
			//	-0.8780971439662140,
			//	-0.2000115337405000,
			//	0.0140546359720426,
			//	-0.8677718655168110,
			//	0.0000000000000091,
			//	-0.0000000000000034,
			//	-0.8658025018107580,
			//	0.2000115337405160,
			//	-0.0140546359720487,
			//	-0.8677718655168110,
			//	0.4022954791496550,
			//	-0.0286340716657209,
			//	-0.8780971439662160,
			//	-0.4009748488032960,
			//	0.0433164473153619,
			//	-0.8520657500708780,
			//	-0.1986097356524730,
			//	0.0218140147785606,
			//	-0.8417126747463890,
			//	0.0000000000000091,
			//	-0.0000000000000036,
			//	-0.8398906081346070,
			//	0.1986097356524930,
			//	-0.0218140147785681,
			//	-0.8417126747463900,
			//	0.4009748488033150,
			//	-0.0433164473153684,
			//	-0.8520657500708790,
			//	-0.4383971340308980,
			//	-0.0404880631578441,
			//	-1.0661003049973400,
			//	-0.2171756069762410,
			//	-0.0203789846827752,
			//	-1.0565961885937500,
			//	0.0000000000000035,
			//	-0.0000000000000022,
			//	-1.0549250541784600,
			//	0.2171756069762480,
			//	0.0203789846827708,
			//	-1.0565961885937500,
			//	0.4383971340309050,
			//	0.0404880631578382,
			//	-1.0661003049973400,
			//	-0.4398736986900770,
			//	-0.0269887834280428,
			//	-1.0905001498603700,
			//	-0.2187688106196130,
			//	-0.0132329749802058,
			//	-1.0810577822896300,
			//	0.0000000000000053,
			//	-0.0000000000000023,
			//	-1.0792467398452400,
			//	0.2187688106196210,
			//	0.0132329749802009,
			//	-1.0810577822896300,
			//	0.4398736986900880,
			//	0.0269887834280381,
			//	-1.0905001498603700,
			//	-0.4386354107842400,
			//	-0.0127883770462009,
			//	-1.1024038720407400,
			//	-0.2184575207784480,
			//	-0.0066028072946568,
			//	-1.0928152369572800,
			//	0.0000000000000057,
			//	-0.0000000000000024,
			//	-1.0908251492028000,
			//	0.2184575207784620,
			//	0.0066028072946510,
			//	-1.0928152369572800,
			//	0.4386354107842520,
			//	0.0127883770461955,
			//	-1.1024038720407400,
			//	-0.4384953938539350,
			//	-0.0000000000000004,
			//	-1.1069214570163600,
			//	-0.2184043268143540,
			//	-0.0000000000000016,
			//	-1.0971709762791100,
			//	0.0000000000000078,
			//	-0.0000000000000033,
			//	-1.0954607977315600,
			//	0.2184043268143690,
			//	-0.0000000000000043,
			//	-1.0971709762791000,
			//	0.4384953938539510,
			//	-0.0000000000000060,
			//	-1.1069214570163700,
			//	-0.4386354107842370,
			//	0.0127883770461998,
			//	-1.1024038720407400,
			//	-0.2184575207784460,
			//	0.0066028072946524,
			//	-1.0928152369572700,
			//	0.0000000000000089,
			//	-0.0000000000000038,
			//	-1.0908251492027900,
			//	0.2184575207784640,
			//	-0.0066028072946594,
			//	-1.0928152369572700,
			//	0.4386354107842540,
			//	-0.0127883770462065,
			//	-1.1024038720407400,
			//	-0.4398736986900740,
			//	0.0269887834280424,
			//	-1.0905001498603600,
			//	-0.2187688106196070,
			//	0.0132329749802014,
			//	-1.0810577822896200,
			//	0.0000000000000087,
			//	-0.0000000000000039,
			//	-1.0792467398452300,
			//	0.2187688106196280,
			//	-0.0132329749802098,
			//	-1.0810577822896200,
			//	0.4398736986900920,
			//	-0.0269887834280496,
			//	-1.0905001498603700,
			//	-0.4383971340308900,
			//	0.0404880631578410,
			//	-1.0661003049973300,
			//	-0.2171756069762350,
			//	0.0203789846827722,
			//	-1.0565961885937400,
			//	0.0000000000000114,
			//	-0.0000000000000048,
			//	-1.0549250541784500,
			//	0.2171756069762540,
			//	-0.0203789846827800,
			//	-1.0565961885937400,
			//	0.4383971340309110,
			//	-0.0404880631578506,
			//	-1.0661003049973300,
			//	-0.4726182490781570,
			//	-0.0373746248830443,
			//	-1.2983182488701800,
			//	-0.2341856193507530,
			//	-0.0188040837296849,
			//	-1.2896720053334500,
			//	0.0000000000000031,
			//	-0.0000000000000031,
			//	-1.2881483169638600,
			//	0.2341856193507610,
			//	0.0188040837296779,
			//	-1.2896720053334500,
			//	0.4726182490781630,
			//	0.0373746248830369,
			//	-1.2983182488701800,
			//	-0.4742009291950260,
			//	-0.0250713275483531,
			//	-1.3208911222247000,
			//	-0.2359096479542910,
			//	-0.0122828044082642,
			//	-1.3123202511587400,
			//	0.0000000000000058,
			//	-0.0000000000000032,
			//	-1.3106743352123700,
			//	0.2359096479543010,
			//	0.0122828044082569,
			//	-1.3123202511587300,
			//	0.4742009291950370,
			//	0.0250713275483464,
			//	-1.3208911222247100,
			//	-0.4728207629437480,
			//	-0.0119589369798846,
			//	-1.3320360633407500,
			//	-0.2355832848786710,
			//	-0.0061599445290269,
			//	-1.3233826989885900,
			//	0.0000000000000064,
			//	-0.0000000000000041,
			//	-1.3215849233550300,
			//	0.2355832848786850,
			//	0.0061599445290205,
			//	-1.3233826989885900,
			//	0.4728207629437610,
			//	0.0119589369798770,
			//	-1.3320360633407400,
			//	-0.4726473233513790,
			//	-0.0000000000000015,
			//	-1.3362743606900900,
			//	-0.2355255568104870,
			//	-0.0000000000000030,
			//	-1.3274849568057300,
			//	0.0000000000000085,
			//	-0.0000000000000036,
			//	-1.3259475214150900,
			//	0.2355255568105030,
			//	-0.0000000000000060,
			//	-1.3274849568057300,
			//	0.4726473233513950,
			//	-0.0000000000000064,
			//	-1.3362743606900900,
			//	-0.4728207629437460,
			//	0.0119589369798827,
			//	-1.3320360633407400,
			//	-0.2355832848786680,
			//	0.0061599445290221,
			//	-1.3233826989885900,
			//	0.0000000000000092,
			//	-0.0000000000000051,
			//	-1.3215849233550300,
			//	0.2355832848786870,
			//	-0.0061599445290306,
			//	-1.3233826989885900,
			//	0.4728207629437640,
			//	-0.0119589369798911,
			//	-1.3320360633407400,
			//	-0.4742009291950200,
			//	0.0250713275483500,
			//	-1.3208911222247000,
			//	-0.2359096479542850,
			//	0.0122828044082579,
			//	-1.3123202511587300,
			//	0.0000000000000117,
			//	-0.0000000000000043,
			//	-1.3106743352123700,
			//	0.2359096479543050,
			//	-0.0122828044082681,
			//	-1.3123202511587300,
			//	0.4742009291950410,
			//	-0.0250713275483593,
			//	-1.3208911222247000,
			//	-0.4726182490781480,
			//	0.0373746248830413,
			//	-1.2983182488701700,
			//	-0.2341856193507450,
			//	0.0188040837296792,
			//	-1.2896720053334400,
			//	0.0000000000000113,
			//	-0.0000000000000051,
			//	-1.2881483169638500,
			//	0.2341856193507690,
			//	-0.0188040837296898,
			//	-1.2896720053334400,
			//	0.4726182490781700,
			//	-0.0373746248830500,
			//	-1.2983182488701700,
			//	-0.5036166169591530,
			//	-0.0340642202591735,
			//	-1.5470292313069800,
			//	-0.2496174797041910,
			//	-0.0171330548842290,
			//	-1.5392424874319600,
			//	0.0000000000000038,
			//	-0.0000000000000045,
			//	-1.5378687262676300,
			//	0.2496174797041980,
			//	0.0171330548842198,
			//	-1.5392424874319600,
			//	0.5036166169591600,
			//	0.0340642202591634,
			//	-1.5470292313069800,
			//	-0.5052718861498360,
			//	-0.0229684379162612,
			//	-1.5676389877441400,
			//	-0.2514298585149480,
			//	-0.0112453059289718,
			//	-1.5599364005464100,
			//	0.0000000000000045,
			//	-0.0000000000000045,
			//	-1.5584539142535900,
			//	0.2514298585149590,
			//	0.0112453059289626,
			//	-1.5599364005464100,
			//	0.5052718861498450,
			//	0.0229684379162510,
			//	-1.5676389877441300,
			//	-0.5037955131562240,
			//	-0.0110138487239018,
			//	-1.5779137403307000,
			//	-0.2510923422469070,
			//	-0.0056625075513358,
			//	-1.5701725686198800,
			//	0.0000000000000074,
			//	-0.0000000000000040,
			//	-1.5685639797158200,
			//	0.2510923422469220,
			//	0.0056625075513247,
			//	-1.5701725686198700,
			//	0.5037955131562380,
			//	0.0110138487238933,
			//	-1.5779137403307100,
			//	-0.5036004193849390,
			//	-0.0000000000000019,
			//	-1.5818264095221900,
			//	-0.2510328891182670,
			//	-0.0000000000000024,
			//	-1.5739731580486500,
			//	0.0000000000000091,
			//	-0.0000000000000057,
			//	-1.5726014377045000,
			//	0.2510328891182840,
			//	-0.0000000000000061,
			//	-1.5739731580486500,
			//	0.5036004193849560,
			//	-0.0000000000000089,
			//	-1.5818264095221900,
			//	-0.5037955131562210,
			//	0.0110138487238982,
			//	-1.5779137403307000,
			//	-0.2510923422469040,
			//	0.0056625075513269,
			//	-1.5701725686198700,
			//	0.0000000000000102,
			//	-0.0000000000000050,
			//	-1.5685639797158200,
			//	0.2510923422469250,
			//	-0.0056625075513391,
			//	-1.5701725686198700,
			//	0.5037955131562410,
			//	-0.0110138487239086,
			//	-1.5779137403307000,
			//	-0.5052718861498280,
			//	0.0229684379162569,
			//	-1.5676389877441300,
			//	-0.2514298585149420,
			//	0.0112453059289639,
			//	-1.5599364005464000,
			//	0.0000000000000109,
			//	-0.0000000000000061,
			//	-1.5584539142535900,
			//	0.2514298585149640,
			//	-0.0112453059289755,
			//	-1.5599364005464000,
			//	0.5052718861498510,
			//	-0.0229684379162681,
			//	-1.5676389877441300,
			//	-0.5036166169591440,
			//	0.0340642202591680,
			//	-1.5470292313069600,
			//	-0.2496174797041810,
			//	0.0171330548842218,
			//	-1.5392424874319500,
			//	0.0000000000000135,
			//	-0.0000000000000064,
			//	-1.5378687262676200,
			//	0.2496174797042070,
			//	-0.0171330548842332,
			//	-1.5392424874319500,
			//	0.5036166169591680,
			//	-0.0340642202591801,
			//	-1.5470292313069600,
			//	-0.5313816151855490,
			//	-0.0306253764613479,
			//	-1.8105548234383500,
			//	-0.2634571763858200,
			//	-0.0153986693246796,
			//	-1.8036275298645800,
			//	0.0000000000000034,
			//	-0.0000000000000046,
			//	-1.8024058046113800,
			//	0.2634571763858280,
			//	0.0153986693246668,
			//	-1.8036275298645800,
			//	0.5313816151855560,
			//	0.0306253764613343,
			//	-1.8105548234383500,
			//	-0.5330822178723140,
			//	-0.0207436452963196,
			//	-1.8291126465460000,
			//	-0.2653249229776930,
			//	-0.0101505901428219,
			//	-1.8222741674660700,
			//	0.0000000000000056,
			//	-0.0000000000000056,
			//	-1.8209556953092000,
			//	0.2653249229777020,
			//	0.0101505901428102,
			//	-1.8222741674660600,
			//	0.5330822178723250,
			//	0.0207436452963074,
			//	-1.8291126465460000,
			//	-0.5315458246133270,
			//	-0.0099935685393317,
			//	-1.8384435243600200,
			//	-0.2649812397489840,
			//	-0.0051292458419801,
			//	-1.8315997870399700,
			//	0.0000000000000069,
			//	-0.0000000000000065,
			//	-1.8301780156254600,
			//	0.2649812397489990,
			//	0.0051292458419678,
			//	-1.8315997870399700,
			//	0.5315458246133410,
			//	0.0099935685393202,
			//	-1.8384435243600200,
			//	-0.5313375525892090,
			//	-0.0000000000000037,
			//	-1.8420012694188200,
			//	-0.2649199204717260,
			//	-0.0000000000000043,
			//	-1.8350660116072200,
			//	0.0000000000000086,
			//	-0.0000000000000055,
			//	-1.8338570860403000,
			//	0.2649199204717460,
			//	-0.0000000000000088,
			//	-1.8350660116072200,
			//	0.5313375525892260,
			//	-0.0000000000000097,
			//	-1.8420012694188200,
			//	-0.5315458246133210,
			//	0.0099935685393270,
			//	-1.8384435243600200,
			//	-0.2649812397489810,
			//	0.0051292458419712,
			//	-1.8315997870399700,
			//	0.0000000000000110,
			//	-0.0000000000000074,
			//	-1.8301780156254600,
			//	0.2649812397490010,
			//	-0.0051292458419831,
			//	-1.8315997870399700,
			//	0.5315458246133430,
			//	-0.0099935685393399,
			//	-1.8384435243600200,
			//	-0.5330822178723070,
			//	0.0207436452963130,
			//	-1.8291126465459900,
			//	-0.2653249229776830,
			//	0.0101505901428118,
			//	-1.8222741674660500,
			//	0.0000000000000120,
			//	-0.0000000000000062,
			//	-1.8209556953091900,
			//	0.2653249229777090,
			//	-0.0101505901428273,
			//	-1.8222741674660500,
			//	0.5330822178723310,
			//	-0.0207436452963262,
			//	-1.8291126465459900,
			//	-0.5313816151855360,
			//	0.0306253764613393,
			//	-1.8105548234383400,
			//	-0.2634571763858100,
			//	0.0153986693246697,
			//	-1.8036275298645700,
			//	0.0000000000000136,
			//	-0.0000000000000080,
			//	-1.8024058046113700,
			//	0.2634571763858360,
			//	-0.0153986693246838,
			//	-1.8036275298645600,
			//	0.5313816151855640,
			//	-0.0306253764613533,
			//	-1.8105548234383400,
			//	-0.5559033528931050,
			//	-0.0271105263579570,
			//	-2.0872213704753500,
			//	-0.2756973544326440,
			//	-0.0136282779664433,
			//	-2.0811601133501800,
			//	0.0000000000000040,
			//	-0.0000000000000063,
			//	-2.0800846246647400,
			//	0.2756973544326520,
			//	0.0136282779664292,
			//	-2.0811601133501800,
			//	0.5559033528931130,
			//	0.0271105263579408,
			//	-2.0872213704753500,
			//	-0.5576269051602190,
			//	-0.0184482813949900,
			//	-2.1036767344165400,
			//	-0.2775945951095380,
			//	-0.0090210699146233,
			//	-2.0977020068235000,
			//	0.0000000000000044,
			//	-0.0000000000000075,
			//	-2.0965472442136500,
			//	0.2775945951095500,
			//	0.0090210699146095,
			//	-2.0977020068235000,
			//	0.5576269051602280,
			//	0.0184482813949757,
			//	-2.1036767344165400,
			//	-0.5560616962041060,
			//	-0.0089284519924784,
			//	-2.1120212910834900,
			//	-0.2772463196573560,
			//	-0.0045753510134594,
			//	-2.1060697133185600,
			//	0.0000000000000084,
			//	-0.0000000000000076,
			//	-2.1048301867394600,
			//	0.2772463196573710,
			//	0.0045753510134439,
			//	-2.1060697133185600,
			//	0.5560616962041200,
			//	0.0089284519924628,
			//	-2.1120212910834900,
			//	-0.5558452163407340,
			//	-0.0000000000000030,
			//	-2.1152071316136800,
			//	-0.2771852073988680,
			//	-0.0000000000000056,
			//	-2.1091821589463400,
			//	0.0000000000000097,
			//	-0.0000000000000079,
			//	-2.1081316550222900,
			//	0.2771852073988850,
			//	-0.0000000000000096,
			//	-2.1091821589463400,
			//	0.5558452163407540,
			//	-0.0000000000000115,
			//	-2.1152071316136800,
			//	-0.5560616962041000,
			//	0.0089284519924705,
			//	-2.1120212910834800,
			//	-0.2772463196573520,
			//	0.0045753510134467,
			//	-2.1060697133185500,
			//	0.0000000000000125,
			//	-0.0000000000000068,
			//	-2.1048301867394600,
			//	0.2772463196573740,
			//	-0.0045753510134650,
			//	-2.1060697133185500,
			//	0.5560616962041210,
			//	-0.0089284519924857,
			//	-2.1120212910834900,
			//	-0.5576269051602090,
			//	0.0184482813949822,
			//	-2.1036767344165400,
			//	-0.2775945951095300,
			//	0.0090210699146122,
			//	-2.0977020068234900,
			//	0.0000000000000119,
			//	-0.0000000000000096,
			//	-2.0965472442136400,
			//	0.2775945951095550,
			//	-0.0090210699146259,
			//	-2.0977020068234900,
			//	0.5576269051602340,
			//	-0.0184482813949989,
			//	-2.1036767344165300,
			//	-0.5559033528930930,
			//	0.0271105263579485,
			//	-2.0872213704753300,
			//	-0.2756973544326320,
			//	0.0136282779664307,
			//	-2.0811601133501600,
			//	0.0000000000000149,
			//	-0.0000000000000083,
			//	-2.0800846246647200,
			//	0.2756973544326610,
			//	-0.0136282779664491,
			//	-2.0811601133501700,
			//	0.5559033528931220,
			//	-0.0271105263579628,
			//	-2.0872213704753300,
			//	-0.5771821068258710,
			//	-0.0235681613083891,
			//	-2.3753715626845600,
			//	-0.2863310671374580,
			//	-0.0118391928908848,
			//	-2.3701615849152200,
			//	0.0000000000000030,
			//	-0.0000000000000071,
			//	-2.3692524735256600,
			//	0.2863310671374650,
			//	0.0118391928908673,
			//	-2.3701615849152200,
			//	0.5771821068258780,
			//	0.0235681613083722,
			//	-2.3753715626845600,
			//	-0.5789137201826750,
			//	-0.0161210044135828,
			//	-2.3897011694571600,
			//	-0.2882312396938590,
			//	-0.0078797154361747,
			//	-2.3845844337134000,
			//	0.0000000000000073,
			//	-0.0000000000000088,
			//	-2.3835986652375600,
			//	0.2882312396938690,
			//	0.0078797154361589,
			//	-2.3845844337133900,
			//	0.5789137201826840,
			//	0.0161210044135648,
			//	-2.3897011694571600,
			//	-0.5773383260003440,
			//	-0.0078469026154178,
			//	-2.3970436278569900,
			//	-0.2878847669732840,
			//	-0.0040112826428413,
			//	-2.3919730292188700,
			//	0.0000000000000064,
			//	-0.0000000000000084,
			//	-2.3909251817568800,
			//	0.2878847669732980,
			//	0.0040112826428223,
			//	-2.3919730292188700,
			//	0.5773383260003590,
			//	0.0078469026154006,
			//	-2.3970436278569800,
			//	-0.5771241406693440,
			//	-0.0000000000000045,
			//	-2.3998504880391400,
			//	-0.2878221982051060,
			//	-0.0000000000000069,
			//	-2.3947257602939000,
			//	0.0000000000000109,
			//	-0.0000000000000086,
			//	-2.3938415431236500,
			//	0.2878221982051240,
			//	-0.0000000000000117,
			//	-2.3947257602938900,
			//	0.5771241406693610,
			//	-0.0000000000000143,
			//	-2.3998504880391400,
			//	-0.5773383260003370,
			//	0.0078469026154085,
			//	-2.3970436278569800,
			//	-0.2878847669732780,
			//	0.0040112826428275,
			//	-2.3919730292188700,
			//	0.0000000000000101,
			//	-0.0000000000000103,
			//	-2.3909251817568700,
			//	0.2878847669733030,
			//	-0.0040112826428439,
			//	-2.3919730292188700,
			//	0.5773383260003610,
			//	-0.0078469026154279,
			//	-2.3970436278569700,
			//	-0.5789137201826630,
			//	0.0161210044135731,
			//	-2.3897011694571500,
			//	-0.2882312396938500,
			//	0.0078797154361594,
			//	-2.3845844337133800,
			//	0.0000000000000142,
			//	-0.0000000000000081,
			//	-2.3835986652375500,
			//	0.2882312396938760,
			//	-0.0078797154361827,
			//	-2.3845844337133800,
			//	0.5789137201826890,
			//	-0.0161210044135901,
			//	-2.3897011694571500,
			//	-0.5771821068258570,
			//	0.0235681613083775,
			//	-2.3753715626845400,
			//	-0.2863310671374460,
			//	0.0118391928908730,
			//	-2.3701615849152100,
			//	0.0000000000000152,
			//	-0.0000000000000115,
			//	-2.3692524735256400,
			//	0.2863310671374760,
			//	-0.0118391928908901,
			//	-2.3701615849152100,
			//	0.5771821068258870,
			//	-0.0235681613083963,
			//	-2.3753715626845500,
			//	-0.5952193115351270,
			//	-0.0200246525466744,
			//	-2.6733302247756100,
			//	-0.2953621505126540,
			//	-0.0100654938179055,
			//	-2.6690048391144800,
			//	0.0000000000000037,
			//	-0.0000000000000091,
			//	-2.6682025680865100,
			//	0.2953621505126610,
			//	0.0100654938178853,
			//	-2.6690048391144900,
			//	0.5952193115351320,
			//	0.0200246525466526,
			//	-2.6733302247756100,
			//	-0.5969217831078420,
			//	-0.0138094792346517,
			//	-2.6855472281976500,
			//	-0.2972498650277940,
			//	-0.0067356906396307,
			//	-2.6813021203321400,
			//	0.0000000000000046,
			//	-0.0000000000000091,
			//	-2.6804582613257000,
			//	0.2972498650278050,
			//	0.0067356906396105,
			//	-2.6813021203321300,
			//	0.5969217831078530,
			//	0.0138094792346321,
			//	-2.6855472281976400,
			//	-0.5953742711176120,
			//	-0.0067650516412163,
			//	-2.6918930265575000,
			//	-0.2968982754807590,
			//	-0.0034505408929328,
			//	-2.6877245445447000,
			//	0.0000000000000079,
			//	-0.0000000000000110,
			//	-2.6868364804388300,
			//	0.2968982754807760,
			//	0.0034505408929123,
			//	-2.6877245445447100,
			//	0.5953742711176240,
			//	0.0067650516411953,
			//	-2.6918930265575000,
			//	-0.5951569367641650,
			//	-0.0000000000000054,
			//	-2.6943248966866400,
			//	-0.2968360118744650,
			//	-0.0000000000000072,
			//	-2.6901196032374400,
			//	0.0000000000000090,
			//	-0.0000000000000099,
			//	-2.6893706455392400,
			//	0.2968360118744840,
			//	-0.0000000000000155,
			//	-2.6901196032374400,
			//	0.5951569367641860,
			//	-0.0000000000000160,
			//	-2.6943248966866300,
			//	-0.5953742711176020,
			//	0.0067650516412061,
			//	-2.6918930265574900,
			//	-0.2968982754807560,
			//	0.0034505408929142,
			//	-2.6877245445446900,
			//	0.0000000000000128,
			//	-0.0000000000000116,
			//	-2.6868364804388200,
			//	0.2968982754807790,
			//	-0.0034505408929364,
			//	-2.6877245445447000,
			//	0.5953742711176260,
			//	-0.0067650516412272,
			//	-2.6918930265575000,
			//	-0.5969217831078340,
			//	0.0138094792346393,
			//	-2.6855472281976300,
			//	-0.2972498650277830,
			//	0.0067356906396150,
			//	-2.6813021203321100,
			//	0.0000000000000130,
			//	-0.0000000000000121,
			//	-2.6804582613257000,
			//	0.2972498650278120,
			//	-0.0067356906396365,
			//	-2.6813021203321100,
			//	0.5969217831078590,
			//	-0.0138094792346623,
			//	-2.6855472281976200,
			//	-0.5952193115351100,
			//	0.0200246525466609,
			//	-2.6733302247755900,
			//	-0.2953621505126420,
			//	0.0100654938178880,
			//	-2.6690048391144700,
			//	0.0000000000000164,
			//	-0.0000000000000109,
			//	-2.6682025680864900,
			//	0.2953621505126730,
			//	-0.0100654938179134,
			//	-2.6690048391144700,
			//	0.5952193115351410,
			//	-0.0200246525466817,
			//	-2.6733302247755900,
			//	-0.6099968906785300,
			//	-0.0165770865148378,
			//	-2.9794545398467700,
			//	-0.3028224133465720,
			//	-0.0082957484744037,
			//	-2.9759275419452700,
			//	0.0000000000000035,
			//	-0.0000000000000094,
			//	-2.9753752578424600,
			//	0.3028224133465780,
			//	0.0082957484743796,
			//	-2.9759275419452700,
			//	0.6099968906785360,
			//	0.0165770865148130,
			//	-2.9794545398467700,
			//	-0.6116919912362620,
			//	-0.0115303316191896,
			//	-2.9895833807521100,
			//	-0.3046403958215260,
			//	-0.0056260057212849,
			//	-2.9861712689246000,
			//	0.0000000000000049,
			//	-0.0000000000000118,
			//	-2.9855533962171400,
			//	0.3046403958215360,
			//	0.0056260057212644,
			//	-2.9861712689246000,
			//	0.6116919912362710,
			//	0.0115303316191649,
			//	-2.9895833807521100,
			//	-0.6101544915231210,
			//	-0.0057220166039325,
			//	-2.9949693507778200,
			//	-0.3042897856648220,
			//	-0.0028990705481534,
			//	-2.9916648129992600,
			//	0.0000000000000090,
			//	-0.0000000000000119,
			//	-2.9910221000438900,
			//	0.3042897856648370,
			//	0.0028990705481282,
			//	-2.9916648129992600,
			//	0.6101544915231350,
			//	0.0057220166039096,
			//	-2.9949693507778100,
			//	-0.6099506597108690,
			//	-0.0000000000000072,
			//	-2.9970379848981500,
			//	-0.3042281782113550,
			//	-0.0000000000000108,
			//	-2.9937191681772200,
			//	0.0000000000000101,
			//	-0.0000000000000109,
			//	-2.9931925837098400,
			//	0.3042281782113740,
			//	-0.0000000000000156,
			//	-2.9937191681772200,
			//	0.6099506597108860,
			//	-0.0000000000000191,
			//	-2.9970379848981500,
			//	-0.6101544915231150,
			//	0.0057220166039205,
			//	-2.9949693507778000,
			//	-0.3042897856648160,
			//	0.0028990705481352,
			//	-2.9916648129992600,
			//	0.0000000000000120,
			//	-0.0000000000000143,
			//	-2.9910221000438800,
			//	0.3042897856648410,
			//	-0.0028990705481592,
			//	-2.9916648129992500,
			//	0.6101544915231370,
			//	-0.0057220166039458,
			//	-2.9949693507778000,
			//	-0.6116919912362530,
			//	0.0115303316191752,
			//	-2.9895833807521000,
			//	-0.3046403958215150,
			//	0.0056260057212657,
			//	-2.9861712689245800,
			//	0.0000000000000147,
			//	-0.0000000000000121,
			//	-2.9855533962171200,
			//	0.3046403958215430,
			//	-0.0056260057212932,
			//	-2.9861712689245800,
			//	0.6116919912362790,
			//	-0.0115303316192000,
			//	-2.9895833807521000,
			//	-0.6099968906785130,
			//	0.0165770865148208,
			//	-2.9794545398467500,
			//	-0.3028224133465590,
			//	0.0082957484743845,
			//	-2.9759275419452500,
			//	0.0000000000000161,
			//	-0.0000000000000139,
			//	-2.9753752578424400,
			//	0.3028224133465910,
			//	-0.0082957484744098,
			//	-2.9759275419452400,
			//	0.6099968906785450,
			//	-0.0165770865148476,
			//	-2.9794545398467500,
			//	-0.6216877767864700,
			//	-0.0131300593991072,
			//	-3.2920195864694300,
			//	-0.3086029754717340,
			//	-0.0066407522965053,
			//	-3.2894840176652900,
			//	0.0000000000000029,
			//	-0.0000000000000127,
			//	-3.2888813968896600,
			//	0.3086029754717400,
			//	0.0066407522964824,
			//	-3.2894840176652900,
			//	0.6216877767864760,
			//	0.0131300593990764,
			//	-3.2920195864694300,
			//	-0.6232076555877200,
			//	-0.0093687665283857,
			//	-3.3001720984433200,
			//	-0.3103799990036430,
			//	-0.0045438500814011,
			//	-3.2977069778848600,
			//	0.0000000000000050,
			//	-0.0000000000000105,
			//	-3.2971081365644800,
			//	0.3103799990036530,
			//	0.0045438500813708,
			//	-3.2977069778848600,
			//	0.6232076555877270,
			//	0.0093687665283611,
			//	-3.3001720984433100,
			//	-0.6217331054793420,
			//	-0.0047047845327862,
			//	-3.3046331461113900,
			//	-0.3100207132989490,
			//	-0.0023780539800244,
			//	-3.3023254179071100,
			//	0.0000000000000080,
			//	-0.0000000000000139,
			//	-3.3017370958244100,
			//	0.3100207132989610,
			//	0.0023780539799966,
			//	-3.3023254179071100,
			//	0.6217331054793570,
			//	0.0047047845327561,
			//	-3.3046331461114000,
			//	-0.6215167950599360,
			//	-0.0000000000000065,
			//	-3.3063479644870400,
			//	-0.3099274051681700,
			//	-0.0000000000000102,
			//	-3.3040599252491000,
			//	0.0000000000000108,
			//	-0.0000000000000150,
			//	-3.3035738784104400,
			//	0.3099274051681880,
			//	-0.0000000000000167,
			//	-3.3040599252490900,
			//	0.6215167950599510,
			//	-0.0000000000000210,
			//	-3.3063479644870300,
			//	-0.6217331054793350,
			//	0.0047047845327694,
			//	-3.3046331461113900,
			//	-0.3100207132989460,
			//	0.0023780539800003,
			//	-3.3023254179071000,
			//	0.0000000000000133,
			//	-0.0000000000000152,
			//	-3.3017370958244000,
			//	0.3100207132989680,
			//	-0.0023780539800322,
			//	-3.3023254179071000,
			//	0.6217331054793550,
			//	-0.0047047845327981,
			//	-3.3046331461113800,
			//	-0.6232076555877080,
			//	0.0093687665283715,
			//	-3.3001720984432900,
			//	-0.3103799990036320,
			//	0.0045438500813750,
			//	-3.2977069778848500,
			//	0.0000000000000128,
			//	-0.0000000000000149,
			//	-3.2971081365644600,
			//	0.3103799990036610,
			//	-0.0045438500814053,
			//	-3.2977069778848400,
			//	0.6232076555877340,
			//	-0.0093687665284006,
			//	-3.3001720984432900,
			//	-0.6216877767864550,
			//	0.0131300593990885,
			//	-3.2920195864694100,
			//	-0.3086029754717200,
			//	0.0066407522964853,
			//	-3.2894840176652600,
			//	0.0000000000000171,
			//	-0.0000000000000152,
			//	-3.2888813968896300,
			//	0.3086029754717520,
			//	-0.0066407522965151,
			//	-3.2894840176652600,
			//	0.6216877767864870,
			//	-0.0131300593991174,
			//	-3.2920195864694100,
			//	-0.6297437008390490,
			//	-0.0101694439944630,
			//	-3.6095496232287300,
			//	-0.3132211169582020,
			//	-0.0049992740647004,
			//	-3.6075780277113800,
			//	0.0000000000000010,
			//	-0.0000000000000130,
			//	-3.6075007823628500,
			//	0.3132211169582090,
			//	0.0049992740646684,
			//	-3.6075780277113800,
			//	0.6297437008390530,
			//	0.0101694439944359,
			//	-3.6095496232287200,
			//	-0.6313277899356890,
			//	-0.0073630499398350,
			//	-3.6157006044358900,
			//	-0.3147560136128690,
			//	-0.0035791508222821,
			//	-3.6139287720706700,
			//	0.0000000000000041,
			//	-0.0000000000000142,
			//	-3.6138468136710700,
			//	0.3147560136128760,
			//	0.0035791508222541,
			//	-3.6139287720706600,
			//	0.6313277899357030,
			//	0.0073630499398015,
			//	-3.6157006044358900,
			//	-0.6298307566481010,
			//	-0.0038609149926555,
			//	-3.6193003816212000,
			//	-0.3142895421120620,
			//	-0.0019383747492887,
			//	-3.6177903583765100,
			//	0.0000000000000055,
			//	-0.0000000000000155,
			//	-3.6177383729060600,
			//	0.3142895421120790,
			//	0.0019383747492572,
			//	-3.6177903583765100,
			//	0.6298307566481130,
			//	0.0038609149926254,
			//	-3.6193003816211900,
			//	-0.6295733207423990,
			//	-0.0000000000000122,
			//	-3.6207487722198100,
			//	-0.3142105752727920,
			//	-0.0000000000000121,
			//	-3.6192797131896200,
			//	0.0000000000000089,
			//	-0.0000000000000163,
			//	-3.6192762657503800,
			//	0.3142105752728060,
			//	-0.0000000000000193,
			//	-3.6192797131896100,
			//	0.6295733207424200,
			//	-0.0000000000000244,
			//	-3.6207487722198100,
			//	-0.6298307566480940,
			//	0.0038609149926401,
			//	-3.6193003816211900,
			//	-0.3142895421120550,
			//	0.0019383747492609,
			//	-3.6177903583765000,
			//	0.0000000000000090,
			//	-0.0000000000000162,
			//	-3.6177383729060500,
			//	0.3142895421120810,
			//	-0.0019383747492953,
			//	-3.6177903583764900,
			//	0.6298307566481160,
			//	-0.0038609149926697,
			//	-3.6193003816211800,
			//	-0.6313277899356800,
			//	0.0073630499398111,
			//	-3.6157006044358700,
			//	-0.3147560136128610,
			//	0.0035791508222594,
			//	-3.6139287720706300,
			//	0.0000000000000130,
			//	-0.0000000000000179,
			//	-3.6138468136710500,
			//	0.3147560136128840,
			//	-0.0035791508222927,
			//	-3.6139287720706400,
			//	0.6313277899357090,
			//	-0.0073630499398453,
			//	-3.6157006044358700,
			//	-0.6297437008390320,
			//	0.0101694439944427,
			//	-3.6095496232286900,
			//	-0.3132211169581890,
			//	0.0049992740646733,
			//	-3.6075780277113600,
			//	0.0000000000000153,
			//	-0.0000000000000156,
			//	-3.6075007823628200,
			//	0.3132211169582210,
			//	-0.0049992740647064,
			//	-3.6075780277113600,
			//	0.6297437008390630,
			//	-0.0101694439944782,
			//	-3.6095496232286900,
			//	-0.6364800528565910,
			//	-0.0068559484399855,
			//	-3.9291820885323900,
			//	-0.3144668610987040,
			//	-0.0034101473928339,
			//	-3.9289424915848800,
			//	0.0000000000000014,
			//	-0.0000000000000173,
			//	-3.9299881510016100,
			//	0.3144668610987060,
			//	0.0034101473928026,
			//	-3.9289424915848800,
			//	0.6364800528565990,
			//	0.0068559484399485,
			//	-3.9291820885323900,
			//	-0.6374533547734390,
			//	-0.0053002778524284,
			//	-3.9340681966059300,
			//	-0.3161990449304770,
			//	-0.0029144862859067,
			//	-3.9336531924023100,
			//	0.0000000000000020,
			//	-0.0000000000000153,
			//	-3.9342831761473700,
			//	0.3161990449304880,
			//	0.0029144862858723,
			//	-3.9336531924023200,
			//	0.6374533547734480,
			//	0.0053002778523931,
			//	-3.9340681966059200,
			//	-0.6356498391163900,
			//	-0.0031595767239875,
			//	-3.9367702357154800,
			//	-0.3158293796942320,
			//	-0.0016455853562617,
			//	-3.9367492248735200,
			//	0.0000000000000079,
			//	-0.0000000000000176,
			//	-3.9374266161548500,
			//	0.3158293796942420,
			//	0.0016455853562270,
			//	-3.9367492248735100,
			//	0.6356498391164080,
			//	0.0031595767239527,
			//	-3.9367702357154700,
			//	-0.6355219821492960,
			//	-0.0000000000000089,
			//	-3.9378889926632300,
			//	-0.3157014360115450,
			//	-0.0000000000000170,
			//	-3.9379859139849600,
			//	0.0000000000000051,
			//	-0.0000000000000174,
			//	-3.9386872774035500,
			//	0.3157014360115650,
			//	-0.0000000000000216,
			//	-3.9379859139849700,
			//	0.6355219821493130,
			//	-0.0000000000000251,
			//	-3.9378889926632300,
			//	-0.6356498391163850,
			//	0.0031595767239651,
			//	-3.9367702357154700,
			//	-0.3158293796942280,
			//	0.0016455853562324,
			//	-3.9367492248735000,
			//	0.0000000000000082,
			//	-0.0000000000000190,
			//	-3.9374266161548300,
			//	0.3158293796942460,
			//	-0.0016455853562701,
			//	-3.9367492248735000,
			//	0.6356498391164120,
			//	-0.0031595767240026,
			//	-3.9367702357154700,
			//	-0.6374533547734290,
			//	0.0053002778524050,
			//	-3.9340681966059000,
			//	-0.3161990449304660,
			//	0.0029144862858761,
			//	-3.9336531924023000,
			//	0.0000000000000125,
			//	-0.0000000000000193,
			//	-3.9342831761473400,
			//	0.3161990449304940,
			//	-0.0029144862859113,
			//	-3.9336531924023100,
			//	0.6374533547734530,
			//	-0.0053002778524406,
			//	-3.9340681966058900,
			//	-0.6364800528565770,
			//	0.0068559484399590,
			//	-3.9291820885323600,
			//	-0.3144668610986890,
			//	0.0034101473928041,
			//	-3.9289424915848500,
			//	0.0000000000000165,
			//	-0.0000000000000176,
			//	-3.9299881510015800,
			//	0.3144668610987170,
			//	-0.0034101473928442,
			//	-3.9289424915848500,
			//	0.6364800528566100,
			//	-0.0068559484399982,
			//	-3.9291820885323600,
			//	-0.6391194718280170,
			//	-0.0045820102079263,
			//	-4.2572238798433200,
			//	-0.3152585885544130,
			//	-0.0020212606262525,
			//	-4.2534960315524400,
			//	0.0000000000000000,
			//	-0.0000000000000194,
			//	-4.2495558293485900,
			//	0.3152585885544180,
			//	0.0020212606262163,
			//	-4.2534960315524500,
			//	0.6391194718280250,
			//	0.0045820102078866,
			//	-4.2572238798433200,
			//	-0.6393799300489870,
			//	-0.0048862673491181,
			//	-4.2580215374867400,
			//	-0.3169995195106480,
			//	-0.0031046808647582,
			//	-4.2557195511945600,
			//	0.0000000000000049,
			//	-0.0000000000000170,
			//	-4.2529567351542100,
			//	0.3169995195106540,
			//	0.0031046808647200,
			//	-4.2557195511945600,
			//	0.6393799300490020,
			//	0.0048862673490795,
			//	-4.2580215374867400,
			//	-0.6377898053048960,
			//	-0.0033326080530608,
			//	-4.2594226743835500,
			//	-0.3167933525284870,
			//	-0.0017223166098601,
			//	-4.2580605348036200,
			//	0.0000000000000061,
			//	-0.0000000000000194,
			//	-4.2562177223677400,
			//	0.3167933525285010,
			//	0.0017223166098241,
			//	-4.2580605348036100,
			//	0.6377898053049090,
			//	0.0033326080530216,
			//	-4.2594226743835500,
			//	-0.6379312883905660,
			//	-0.0000000000000113,
			//	-4.2609655778534400,
			//	-0.3166627002012890,
			//	-0.0000000000000165,
			//	-4.2595031981273300,
			//	0.0000000000000090,
			//	-0.0000000000000200,
			//	-4.2572955883670100,
			//	0.3166627002013030,
			//	-0.0000000000000220,
			//	-4.2595031981273200,
			//	0.6379312883905870,
			//	-0.0000000000000265,
			//	-4.2609655778534400,
			//	-0.6377898053048890,
			//	0.0033326080530333,
			//	-4.2594226743835400,
			//	-0.3167933525284870,
			//	0.0017223166098289,
			//	-4.2580605348036000,
			//	0.0000000000000090,
			//	-0.0000000000000203,
			//	-4.2562177223677300,
			//	0.3167933525285070,
			//	-0.0017223166098687,
			//	-4.2580605348036000,
			//	0.6377898053049090,
			//	-0.0033326080530736,
			//	-4.2594226743835300,
			//	-0.6393799300489780,
			//	0.0048862673490902,
			//	-4.2580215374867200,
			//	-0.3169995195106340,
			//	0.0031046808647223,
			//	-4.2557195511945400,
			//	0.0000000000000133,
			//	-0.0000000000000204,
			//	-4.2529567351541900,
			//	0.3169995195106600,
			//	-0.0031046808647654,
			//	-4.2557195511945300,
			//	0.6393799300490070,
			//	-0.0048862673491309,
			//	-4.2580215374867200,
			//	-0.6391194718280030,
			//	0.0045820102078956,
			//	-4.2572238798432900,
			//	-0.3152585885543990,
			//	0.0020212606262214,
			//	-4.2534960315524200,
			//	0.0000000000000159,
			//	-0.0000000000000214,
			//	-4.2495558293485700,
			//	0.3152585885544280,
			//	-0.0020212606262573,
			//	-4.2534960315524200,
			//	0.6391194718280330,
			//	-0.0045820102079381,
			//	-4.2572238798432900
			//};


			//for (int i = 0; i < displacementVectorExpected.Length; i++)
			//	Assert.Equal(displacementVectorExpected[i], linearSystems[0].Solution[i], 6);

			#endregion

		}

		//[Fact]
		public void TSplinesShellsBenchmark()
		{
			VectorExtensions.AssignTotalAffinityCount();
			Model model = new Model();
			string filename = "..\\..\\..\\IGA\\InputFiles\\tspline.iga";
			IGAFileReader modelReader = new IGAFileReader(model, filename);
			modelReader.CreateTSplineShellsModelFromFile();

			model.PatchesDictionary[0].Material = new ElasticMaterial2D(StressState2D.PlaneStress)
			{
				PoissonRatio = 0.3,
				YoungModulus = 10e6
			};
			model.PatchesDictionary[0].Thickness = 0.1;

			for (int i = 0; i < 100; i++)
			{
				model.ControlPointsDictionary[i].Constrains.Add(DOFType.X);
				model.ControlPointsDictionary[i].Constrains.Add(DOFType.Y);
				model.ControlPointsDictionary[i].Constrains.Add(DOFType.Z);
			}

			for (int i = 0; i < model.ControlPoints.Count - 100; i++)
			{
				model.Loads.Add(new Load() { Amount = -1000, ControlPoint = model.ControlPointsDictionary[i], DOF = DOFType.Y });
			}


			//model.Loads.Add(new Load() { Amount = -10000, ControlPoint = model.ControlPointsDictionary[2], DOF = DOFType.Y });
			model.ConnectDataStructures();

			var linearSystems = new Dictionary<int, ILinearSystem>();
			linearSystems[0] = new SkylineLinearSystem(0, model.PatchesDictionary[0].Forces);
			SolverSkyline solver = new SolverSkyline(linearSystems[0]);
			ProblemStructural provider = new ProblemStructural(model, linearSystems);
			LinearAnalyzer analyzer = new LinearAnalyzer(solver, linearSystems);
			StaticAnalyzer parentAnalyzer = new StaticAnalyzer(provider, analyzer, linearSystems);

			parentAnalyzer.BuildMatrices();
			parentAnalyzer.Initialize();
			parentAnalyzer.Solve();
		}
	}
}